<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Source Code Generator</title>
</head>
<body>

  <h2>Fill in the details:</h2>

  <!-- Your input fields -->
  <label>Company Name:</label>
  <input type="text" id="companyName"><br>

  <label>Country of Artist Origin:</label>
  <input type="text" id="artistCountry"><br>

  <label>Event Title:</label>
  <input type="text" id="eventTitle"><br>

  <label>Year Art Created:</label>
  <input type="text" id="yearCreated"><br>

  <label>Premiere Type (if any):</label>
  <input type="text" id="premiereType"><br>

  <label>Video Link URL:</label>
  <input type="text" id="videoLink"><br>

  <label>Date & Time of Event:</label>
  <input type="text" id="eventDateTime"><br>

  <label>Duration:</label>
  <input type="text" id="eventDuration"><br>

  <label>Intermission (true/false):</label>
  <input type="text" id="intermission"><br>

  <label>Venue:</label>
  <input type="text" id="venue"><br>

  <label>Venue Location:</label>
  <input type="text" id="venueLocation"><br>

  <label>Tkkl Ticket Link:</label>
  <input type="text" id="ticketLink"><br>

  <label>Festival Pass Link:</label>
  <input type="text" id="festivalPassLink"><br>

  <label>Artist Fund Credit:</label>
  <input type="text" id="artistFundCredit"><br>

  <label>Artist 1 Skill Title:</label>
  <input type="text" id="artist1Skill"><br>

  <label>Artist 1 Name:</label>
  <input type="text" id="artist1Name"><br>

  <label>Artist 2 Skill Title:</label>
  <input type="text" id="artist2Skill"><br>

  <label>Artist 2 Name:</label>
  <input type="text" id="artist2Name"><br>

  <label>Artist 3 Skill Title:</label>
  <input type="text" id="artist3Skill"><br>

  <label>Artist 3 Name:</label>
  <input type="text" id="artist3Name"><br>

  <label>Artist 4 Skill Title:</label>
  <input type="text" id="artist4Skill"><br>

  <label>Artist 4 Name:</label>
  <input type="text" id="artist4Name"><br>

  <label>Artist Website:</label>
  <input type="text" id="artistWebsite"><br>

  <label>Artist Facebook Page:</label>
  <input type="text" id="artistFacebook"><br>

  <label>Instagram Link:</label>
  <input type="text" id="artistInstagram"><br>

  <label>Artist Twitter Page:</label>
  <input type="text" id="artistTwitter"><br>

  <label>Event Description:</label>
  <input type="text" id="eventDescription"><br>

  <label>Company History:</label>
  <input type="text" id="companyHistory"><br>

  <label>Artist 1 Description:</label>
  <input type="text" id="artist1Desc"><br>

  <label>Artist 2 Description:</label>
  <input type="text" id="artist2Desc"><br>

  <label>Artist 3 Description:</label>
  <input type="text" id="artist3Desc"><br>

  <label>Artist 4 Description:</label>
  <input type="text" id="artist4Desc"><br>

  <label>Shared Bill (yes/no):</label>
  <input type="text" id="sharedBill"><br><br>

  <!-- Button 1: Generate & also save to Google Sheets -->
  <button onclick="generateAndSave()">Generate & Save</button>
  
  <!-- Button 2: Save to Google Sheets only (no generation) -->
  <button onclick="submitData()">Save to Excel Sheet</button>

  <!-- Optional: Copy the generated HTML -->
  <button onclick="copyToClipboard()">Copy</button>

  <!-- Where the generated HTML appears -->
  <pre id="output"></pre>

  <script>
    // Your Web App URL from Google Apps Script
    const webAppUrl = "https://script.google.com/macros/s/AKfycbxdaDPvwSKi_NYwJzS5HTOatU3RXyrK9CwlXKt0gI31IFpFn0k35xesBvsLg950by-Kog/exec";

    // 1) Generate final HTML code (does NOT automatically save to Sheets)
    function generateCode() {
      const generatedCode =
`<div>
<div class="artists-left">
<h1><strong>${document.getElementById("companyName").value}</strong></h1>
<h3>(${document.getElementById("artistCountry").value})</h3>
<h1><em>${document.getElementById("eventTitle").value}<br /></em></h1>
<h3>(${document.getElementById("yearCreated").value}, ${document.getElementById("premiereType").value})</h3>
<p><br />${document.getElementById("videoLink").value}</p>
<p><strong>Date(s) &amp; Time(s)</strong>: ${document.getElementById("eventDateTime").value}<br />
<strong>Duration</strong>: ${document.getElementById("eventDuration").value} (${document.getElementById("intermission").value})<br />
<strong>Venue</strong>: ${document.getElementById("venue").value}, <br />
<strong>Location</strong>: ${document.getElementById("venueLocation").value}</p>
<h3>Ticket Information</h3>
<p><strong>Early Bird: $20, Advance: $25, Door: $28<br /></strong>
For the best deals, see multiple shows with a discount Festival Pass.<br />
<strong><a class="submit-button" rel="noreferrer" href="${document.getElementById("ticketLink").value}">TICKETS</a></strong>
<strong><a class="submit-button" rel="noopener noreferrer" href="${document.getElementById("festivalPassLink").value}">FESTIVAL PASS</a></strong></p>
<p><br /><strong>Funding Credits:</strong> ${document.getElementById("artistFundCredit").value}</p>
<h3>Artist Information</h3>
<p class="p1">
<strong>${document.getElementById("artist1Skill").value}:</strong> ${document.getElementById("artist1Name").value}<br />
<strong>${document.getElementById("artist2Skill").value}:</strong> ${document.getElementById("artist2Name").value}<br />
<strong>${document.getElementById("artist3Skill").value}:</strong> ${document.getElementById("artist3Name").value}<br />
<strong>${document.getElementById("artist4Skill").value}:</strong> ${document.getElementById("artist4Name").value}
</p>
<h3>Artist Website</h3>
<p><a rel="noopener" href="${document.getElementById("artistWebsite").value}" target="_blank">Visit Artist Website</a></p>
<h3>Social Media Accounts</h3>
<p>
  <a rel="noopener" href="${document.getElementById("artistFacebook").value}" target="_blank">
    <img src="https://assets.nationbuilder.com/festival/pages/4374/attachments/original/1707667013/Facebook_Logo.jpg?1707667013" alt="Facebook_Logo.jpg" width="50" height="50" />
  </a>&nbsp;
  <a rel="noopener" href="${document.getElementById("artistInstagram").value}" target="_blank">
    <img src="https://assets.nationbuilder.com/festival/pages/7317/attachments/original/1738340022/Instagram_logo.jpg?1738340022" alt="" width="50" height="50" />
  </a>&nbsp;
  <a rel="noopener" href="${document.getElementById("artistTwitter").value}" target="_blank">
    <img src="https://assets.nationbuilder.com/festival/pages/7179/attachments/original/1738015635/XLogo.png?1738015635" alt="" width="50" height="50" />
  </a>
</p>
</div>
<p class="artists-right"><img alt="" width="1200" height="700" /></p>
<h3>Production Details</h3>
${document.getElementById("eventDescription").value}<br /><br />
<strong>Company History<br /></strong>${document.getElementById("companyHistory").value}<br /><strong></strong></div>
<p><strong>Artist Biographies<br /><br /></strong>
<strong>${document.getElementById("artist1Name").value}<br /></strong>${document.getElementById("artist1Desc").value}<br /><br />
<strong>${document.getElementById("artist2Name").value}<br /></strong>${document.getElementById("artist2Desc").value}<br /><br />
<strong>${document.getElementById("artist3Name").value}<br /></strong>${document.getElementById("artist3Desc").value}<br /><br />
<strong>${document.getElementById("artist4Name").value}<br /></strong>${document.getElementById("artist4Desc").value}
</p>
<p><br />Extra Information Section:<br />${document.getElementById("sharedBill").value}</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>
<p>&nbsp;</p>`;

      // Show the code in <pre>
      document.getElementById("output").textContent = generatedCode;
      return generatedCode;
    }

    // 2) Gather all fields into a single object (plus the generated code)
    function buildPayload() {
      const generatedHTML = document.getElementById("output").textContent; 
      // If code is not yet generated, we can call generateCode() first. 
      // Or just rely on what's in <pre>.
      
      const userInputData = {
        companyName:      document.getElementById("companyName").value,
        artistCountry:    document.getElementById("artistCountry").value,
        eventTitle:       document.getElementById("eventTitle").value,
        yearCreated:      document.getElementById("yearCreated").value,
        premiereType:     document.getElementById("premiereType").value,
        videoLink:        document.getElementById("videoLink").value,
        eventDateTime:    document.getElementById("eventDateTime").value,
        eventDuration:    document.getElementById("eventDuration").value,
        intermission:     document.getElementById("intermission").value,
        venue:            document.getElementById("venue").value,
        venueLocation:    document.getElementById("venueLocation").value,
        ticketLink:       document.getElementById("ticketLink").value,
        festivalPassLink: document.getElementById("festivalPassLink").value,
        artistFundCredit: document.getElementById("artistFundCredit").value,
        artist1Skill:     document.getElementById("artist1Skill").value,
        artist1Name:      document.getElementById("artist1Name").value,
        artist2Skill:     document.getElementById("artist2Skill").value,
        artist2Name:      document.getElementById("artist2Name").value,
        artist3Skill:     document.getElementById("artist3Skill").value,
        artist3Name:      document.getElementById("artist3Name").value,
        artist4Skill:     document.getElementById("artist4Skill").value,
        artist4Name:      document.getElementById("artist4Name").value,
        artistWebsite:    document.getElementById("artistWebsite").value,
        artistFacebook:   document.getElementById("artistFacebook").value,
        artistInstagram:  document.getElementById("artistInstagram").value,
        artistTwitter:    document.getElementById("artistTwitter").value,
        eventDescription: document.getElementById("eventDescription").value,
        companyHistory:   document.getElementById("companyHistory").value,
        artist1Desc:      document.getElementById("artist1Desc").value,
        artist2Desc:      document.getElementById("artist2Desc").value,
        artist3Desc:      document.getElementById("artist3Desc").value,
        artist4Desc:      document.getElementById("artist4Desc").value,
        sharedBill:       document.getElementById("sharedBill").value
      };

      const payload = {
        userInput: userInputData,
        generatedCode: generatedHTML
      };
      return payload;
    }

    // 3) Actually submit to your Google Sheets via doPost(e)
    function submitData() {
      const payload = buildPayload();

      fetch(webAppUrl, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(payload),
      })
      .then(response => response.text())
      .then(data => {
        console.log("Google Sheets response:", data);
        alert("Data appended to Google Sheet: " + data);
      })
      .catch(error => {
        console.error("Error:", error);
        alert("Error while saving to Google Sheets:\n" + error);
      });
    }

    // 4) A combined function: Generate code first, then submit to Sheets
    function generateAndSave() {
      // 1) Generate code
      generateCode(); 
      // 2) Then immediately save to sheet
      submitData();
    }

    // 5) Copy the generated code from <pre> to clipboard
    function copyToClipboard() {
      const textToCopy = document.getElementById("output").textContent;
      navigator.clipboard.writeText(textToCopy)
        .then(() => { alert("Copied to clipboard!"); })
        .catch(err => console.error("Failed to copy: ", err));
    }
  </script>
</body>
</html>